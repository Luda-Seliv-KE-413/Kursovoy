:imagesdir: images
:toc: macro
:icons: font
:figure-caption: Рисунок
:table-caption: Таблица
:stem: Формула
:sourcedir: CODE


=== Код программы для измерения гликемии (уровня глюкозы в крови)

Для решения задачи измерения гликемии был создан класс задачи MeasureGlycemiaTask код которого представлен ниже.

класс MeasureGlycemiaTask.h
[.source, cpp]
----
#ifndef MEASUREGLYCEMIATASK
#define MEASUREGLYCEMIATASK
#include "thread.hpp" // for OsWrapper::Thread<>

#include <iostream> // for std::cout

class MeasureGlycemiaTask : public IThread
{
public:
  
  MeasureGlycemiaTask (ICalculate& glycemia, ICalculate& temperature, ICalculate& frequency) : 
    mGlycemia(glycemia), mTemperature(temperature), mFrequency(frequency) //?????????
  {
    
  }
  void Execute() override
    {
      for(;;) //???? ??????? ????????
      {
        mFrequency.Calculate();
        mTemperature.Calculate();
        mGlycemia.Calculate();
        Sleep(30000ms); //?????? ????? 5 ?????
      }
    }
  
private:
  ICalculate& mGlycemia;
  ICalculate& mTemperature;
  ICalculate& mFrequency;
};

#endif
----

Для измерения гликемии необходимо получить информацию о частоте кварцевого резонатора, преобразовать частоту в температуру, а температуру уже в значения гликемии.

Коды для получения значений гликемии (класс Glycemia.h)  из температуры (класс Temperature.h) представлены ниже:

класс Glycemia.h
[.source, cpp]
----
//include::{sourcedir}/org/asciidoctor/Asciidoctor.java[]
----

класс Temperature.h
[.source, cpp]
----
//include::{sourcedir}/org/asciidoctor/Asciidoctor.java[]
----

Для преобразования (пересчета) значений температуры в значения гликемии используется интерфейс, код которого представлен ниже:

интерфейс ICalculate
[.source, cpp]
----
//include::{sourcedir}/org/asciidoctor/Asciidoctor.java[]
----


(черновик *.cpp файла для температуры)
[.source, cpp]
----
    //freqT=freq0+A1*Z+A2*Z^2+A3*Z^3
    //Z=T-T0
    //T -? (преобразовать формулы под расчет температуры)
    /*  private:
            const std::float_t freq0=32767f; //Опорная частота (опорной частотойявляется чатота RTC = 32767)
            const std::float_t A1=-1.811; //Коэффициент 1го порядка
            const std::float_t A2=-0.0028; //Коэффициент 2го порядка
            const std::float_t A3=7.6*pow(10,-6); //Коэффициент 3го порядка
            //freqT - значения переменной считываются с датчика*/
----